language: go
go:
- "1.13.x"
- "1.12.x"
- "1.11.x"
- "1.10.x"
sudo: false
script:
- go test
before_deploy:
- mkdir -p release
- export GOOS=linux GOARCH=amd64; go build -o release/check-prometheusexporter-${GOOS}-${GOARCH}
- export GOOS=linux GOARCH=386; go build -o release/check-prometheusexporter-${GOOS}-${GOARCH}
- export GOOS=darwin GOARCH=amd64; go build -o release/check-prometheusexporter-${GOOS}-${GOARCH}
- export GOOS=windows GOARCH=amd64; go build -o release/check-prometheusexporter-${GOOS}-${GOARCH}
- export GOOS=windows GOARCH=386; go build -o release/check-prometheusexporter-${GOOS}-${GOARCH}
deploy:
  provider: releases
  prerelease: true
  api_key:
    secure: WGGAzfSHk6mnUDxu0gFp0QoxBRrHnFjCElG/8dlO2lMJT0iUcr6aOLXwS5pwCtxeydshBAQ5rPbKPBJNK4cslJxrgm4vvvkobLxr9MkhmfqkzUUlYIz99+yid8fZTHjWI9MmRbo4yTrNhzfT6pZe01z1j+moXcZXnVhNTrAntUPsp/610YKw+4toeJnIVCXJiWvZK+hSt36bl0KK6/gPzxVwsa0RJBXgLlwvaL/71xfE1h2bQcm96kmORWDgYeaQ4mkjBBI067277dpYTd1ztzP/mScOlhDPb463iXTOJ+q587XbzieoGJ9LKQ1L/RdMuXhmc9FrEC/Kr3LrZI3m5RVpAOEfP8/6eYb6zOIKEwt5tb1rxC6gXOfFHAb4lcAvf94SUUZdI5ivnUNLFpzkrPgNah5SuJQB3S8p+yFovKC2k8K6TZH/CGyIRK+C3e4498cF6rwUQlzMuNNUzS39N6KW4ZQhNvhOvgS/rMF6TPsXF/OZ9n2TOWYyIIqBYPlj/GPup1IbOTDS+nyvXkcIyrFTuN88Q88aja3xCL4aIzRtEl16YvPe4+d+ryUb/4WRCJma5OOh9gAs6OEvj+Q4u9eJK9UmldHAxUqmxe+Dw0nzwtY0dYVfX7sNx0eNlvE0izxzaB1ibKDFj7msTrXa2zaOPIxgbW83mvbaslEGNO4=
  file_glob: true
  file: release/*
  skip_cleanup: true
  on:
    repo: nxadm/check-prometheusexporter
    tags: true
  branches:
    only:
    - "/^v\\d+\\.\\d+\\.\\d+$/"
